{
  "name": "Shoot Your friends",
  "tagline": "Elec 327 Final Project",
  "body": "# Shoot Your Friends\r\n## Created by Keiko Kaplan and Alice Xie\r\n\r\nWhen you were younger, you used to get into pretend firefights with your friends. You'd shape your hand into a gun and shout \"Bang!\". Heck, maybe you still do. But now that you're older, shooting imaginary bullets just doesn't cut it anymore.\r\n\r\n*Trailer video goes here*\r\n### Team LTSpice Girls is pleased to announce *Shoot Your Friends*\r\n\r\n*Detailed video goes here*\r\n\r\n## Report\r\n\r\n“Shoot your Friends” is a game where you try to shoot your friends, but in a non-lethal and fun way. \r\n\r\nEach player wears two devices - one on their arm, and one on their chest. The arm board has an MSP430g2553 microcontroller for processing, a button that functions as the trigger, a laser for shooting, an LED strip to display energy, and a piezo buzzer for sound effects.\r\n\r\nThe chest board also has a MSP430g2553 for processing, a phototransistor array as the target, a ring of LEDs to display health, and a piezo buzzer for sound effects.\r\n\r\nThe design works as follows\r\n\r\n1. Player A presses the trigger button on the arm board and holds it for a length of time. \r\n2. As hold time increases, the shot powers up. The LED string on player A’s arm changes color to display power consumption upon button release.\r\n3. When player A releases the button, the laser on player A’s arm board  fires and modulates at frequency to communicate the shot power.\r\n4. Player A consumes energy to fire the shot, and energy consumption is reflected in changes in the arm board’s LED display.\r\n5. If player A’s laser hits a phototransistor on player B’s chest board, the ADC in the MSP430 will register higher values and consequently a hit.\r\n6. Player B’s chest board demodulates by calculating modulation period.\r\n7. Player B takes damage associated with the modulation period and loses health.\r\n8. Player B’s chest board LEDs update to display remaining health, and the piezo buzzer plays the “you’ve been hit” sound effect.\r\n\r\n![System Image](https://raw.githubusercontent.com/Dublekfx/Shoot-Your-Friends/gh-pages/images/System%20Diagram%201.PNG)\r\n\r\nThe key aspect of this project is the communication between the laser on the arm board and the phototransistor array on the chest board. The following details our design of this project along with challenges and workarounds we implemented.\r\n\r\n### Laser modulation/demodulation\r\n\r\nThe laser is modulated at different frequencies to communicate shot power.\r\n\r\n![Modulation](https://raw.githubusercontent.com/Dublekfx/Shoot-Your-Friends/gh-pages/images/Modulation.PNG)\r\n\r\nHowever, the MSP430g2553 only has two timer modules. One of them is used to control the piezo buzzer, and the other is used for SPI communication to the LED strips.\r\n\r\nThis leaves us having to implement the PWM output for the laser modulation in software.\r\n\r\nAt its fastest, the laser needed to modulate with a period of 0.25 milliseconds.\r\n\r\nThe microcontroller clock ran at 12 Mhz, the highest frequency possible when running on 3V. However, each cycle of the main loop also potentially required updating an LED display, debouncing the trigger button, calculating button hold time, and playing sound effects. \r\n\r\nThe amount of operations required per cycle makes it impossible to complete a cycle in 0.25 milliseconds.\r\n\r\nTherefore, laser modulation is performed in an interrupt. While having long interrupt routines is generally bad design, it is necessary in this case, and potential dangers of having long interrupt routines is offset by having only a watchdog interrupt.\r\n\r\nSimilarly, demodulation on the chest board is also performed in the watchdog interrupt. The processor records the time between rising and falling edges detected by the phototransistor array. Transition time is summed up across 16 transitions to calculate the modulation time and corresponding damage received.\f\r\n\r\n### Phototransistor sensors\r\n\r\nEach chest board has an array of five phototransistors. The transistors used in this project are PT33406C NPN transistors by Everlight. In their off state, their output is connected to ground by a pull-down resistor. When light from the laser hits them,the output voltage increases depending on luminosity.\r\n\r\n![Target Schematic](https://raw.githubusercontent.com/Dublekfx/Shoot-Your-Friends/gh-pages/images/Target%20Schematic.PNG)\r\n\r\nHowever, since the voltage increase isn’t always large enough to be read as a digital high, we configure the input pin to send the data to the ADC10.\r\n\r\nUpon startup, the ADC10 automatically calibrates itself and calculate a base value.\r\n\r\nHysteresis is performed in detecting hits by the laser. To initially register a hit by the laser, the ADC must read out an value of at least base + 25. Further ADC values must be at least base + 15 to register as high. Values below will be registered as low.\r\n\r\n### User Interface\r\n\r\nThe arm and chest boards both use a combination of LEDs and a piezo buzzer to convey information to the user. The chest board emits a tune on startup, and plays a tone every time it registers damage. When the player’s health has reached 0, it plays a “game over” tune. It must then be power cycled in order to play again.\r\n\r\nThe arm board also plays a tune upon startup. When the user holds the trigger, a tone of increasing pitch will sound, with the pitch dependant upon the power of the shot. The board will trill when the button is released to indicate that it is firing. There is also feedback if the user attempts to fire but is out of energy, and when the energy has fully recharged. The LED strip on the arm board displays current energy, and energy to be used when firing.",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}